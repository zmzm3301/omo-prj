{"ast":null,"code":"import _slicedToArray from\"C:/Users/zmzm3/git/omo/omo-prj/src/main/react-prj-sample-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{useCookies}from\"react-cookie\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function KakaoLogin(){var _useCookies=useCookies('nickName'),_useCookies2=_slicedToArray(_useCookies,3),removeCookie=_useCookies2[2];var KAKAO_LOGOUT_URL=\"http://localhost:3000/klogout\";var _useState=useState(''),_useState2=_slicedToArray(_useState,2),kperson=_useState2[0],setKPerson=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),nickName=_useState4[0],setNickName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),authority=_useState6[0],setAuthority=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),email=_useState8[0],setEmail=_useState8[1];var params=new URLSearchParams(window.location.search);var code=params.get(\"code\");function deleteCookie(){removeCookie('nickName');axios.get('/deleteCookie');}useEffect(function(){if(code!==null){axios.get('/klogin',{params:{code:code}}).then(function(response){setKPerson(response.data);window.location.assign(\"http://localhost:3000\");});}},[code,email,kperson,nickName]);useEffect(function(){// if(kperson !== \"\" && kperson !== null) {\naxios.get(\"/getCookie\").then(function(response){var arr=response.data.split(\" \");var nickName=arr[0];var email=arr[1];var authority=arr[2];setNickName(nickName);setEmail(email);setAuthority(authority);});// }\n},[kperson]);console.log(nickName);useEffect(function(){if(nickName!==\"\"){axios.post(\"/addkperson\",null,{params:{nick_name:nickName,email:email,authority:authority}});}},[email,nickName]);var POSTURI=\"http://localhost:3000/post/list\";//eslint-disable-line no-unused-vars\nif(nickName){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white nav-item\",children:nickName}),/*#__PURE__*/_jsx(\"a\",{className:\"w-16 h-8\",href:KAKAO_LOGOUT_URL,id:\"logout\",onClick:deleteCookie,children:/*#__PURE__*/_jsx(\"button\",{className:\"w-16 h-8 text-white bg-blue-600 border-none rounded-md hover:bg-blue-800\",children:\"Logout\"})})]});}else{return/*#__PURE__*/_jsx(\"button\",{className:\"w-16 h-8 text-white bg-blue-600 border-none rounded-md hover:bg-blue-800\",children:/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Login\"})});}}export default KakaoLogin;","map":{"version":3,"names":["React","axios","useEffect","useState","useCookies","Link","KakaoLogin","removeCookie","KAKAO_LOGOUT_URL","kperson","setKPerson","nickName","setNickName","authority","setAuthority","email","setEmail","params","URLSearchParams","window","location","search","code","get","deleteCookie","then","response","data","assign","arr","split","console","log","post","nick_name","POSTURI"],"sources":["C:/Users/zmzm3/git/omo/omo-prj/src/main/react-prj-sample-main/src/components/KakaoLogin.js"],"sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\n\r\nfunction KakaoLogin() {\r\n    const [, , removeCookie] = useCookies('nickName')\r\n\r\n    const KAKAO_LOGOUT_URL = `http://localhost:3000/klogout`\r\n\r\n    const [kperson, setKPerson] = useState('')\r\n    const [nickName, setNickName] = useState('')\r\n    const [authority, setAuthority] = useState('')\r\n    const [email, setEmail] = useState('')\r\n\r\n    const params = new URLSearchParams(window.location.search);\r\n    const code = params.get(\"code\");\r\n\r\n    function deleteCookie() {\r\n        removeCookie('nickName');   \r\n        axios.get('/deleteCookie')\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(code !== null) {\r\n            axios.get('/klogin',\r\n                    {params: {code: code}}\r\n                ).then(response => { \r\n                    setKPerson(response.data)\r\n                    window.location.assign(\"http://localhost:3000\")\r\n                })\r\n            }\r\n    }, [code, email, kperson, nickName])\r\n\r\n    useEffect(()=> {\r\n        // if(kperson !== \"\" && kperson !== null) {\r\n            axios.get(\"/getCookie\").then(response => {\r\n                var arr = response.data.split(\" \")\r\n                const nickName = arr[0];\r\n                const email = arr[1];\r\n                const authority = arr[2];\r\n    \r\n                setNickName(nickName)\r\n                setEmail(email)\r\n                setAuthority(authority)\r\n            })\r\n        // }\r\n    }, [kperson])\r\nconsole.log(nickName)\r\n    useEffect(() => {\r\n        if(nickName !== \"\") {\r\n            axios.post(\"/addkperson\", null, {\r\n                params: {\r\n                    nick_name: nickName,\r\n                    email: email,\r\n                    authority: authority,\r\n                }\r\n            })\r\n        }\r\n    }, [email, nickName])\r\n\r\n    const POSTURI = \"http://localhost:3000/post/list\"//eslint-disable-line no-unused-vars\r\n\r\n    if (nickName) {\r\n        return  <>\r\n                    <p className=\"text-white nav-item\">{nickName}</p>\r\n                    <a className=\"w-16 h-8\" href={KAKAO_LOGOUT_URL} id=\"logout\" onClick={deleteCookie}>\r\n                        <button className=\"w-16 h-8 text-white bg-blue-600 border-none rounded-md hover:bg-blue-800\">\r\n                            Logout\r\n                        </button>\r\n                    </a>\r\n                </>\r\n    } else {\r\n        return  <button className=\"w-16 h-8 text-white bg-blue-600 border-none rounded-md hover:bg-blue-800\">\r\n                    <Link to=\"/login\">Login</Link>\r\n                </button>\r\n    }\r\n\r\n}\r\n\r\nexport default KakaoLogin;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}