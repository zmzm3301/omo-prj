{"ast":null,"code":"import _objectSpread from\"C:/Users/zmzm3/git/omo/omo-prj/src/main/react-prj-sample-main/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/zmzm3/git/omo/omo-prj/src/main/react-prj-sample-main/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{RiKakaoTalkFill}from\"react-icons/ri\";import{Link,useNavigate}from\"react-router-dom\";import axios from\"axios\";import{setMessage,login}from\"../stores/actions\";import jwt_decode from'jwt-decode';import{useSelector,useDispatch}from\"react-redux\";import{useState,useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(){var isLoggedIn=useSelector(function(state){return state.isLoggedIn;});var userRole=useSelector(function(state){return state.userRole;});var REST_API_KEY=\"8ef1d7ff4079cc081e948ea0988aafea\";var REDIRECT_URI=\"http://localhost:3000/klogin\";var KAKAO_AUTH_URL=\"https://kauth.kakao.com/oauth/authorize?client_id=\".concat(REST_API_KEY,\"&redirect_uri=\").concat(REDIRECT_URI,\"&response_type=code&prompt=login;\");var _useState=useState(''),_useState2=_slicedToArray(_useState,2),kperson=_useState2[0],setKPerson=_useState2[1];var params=new URLSearchParams(window.location.search);var code=params.get(\"code\");var navigate=useNavigate();var message=useSelector(function(state){return state.message;});var isLogin=useSelector(function(state){return state.isLoggedIn;});var dispatch=useDispatch();var _useState3=useState({id:'',pw:''}),_useState4=_slicedToArray(_useState3,2),input=_useState4[0],set_input=_useState4[1];var onClickLogin=function onClickLogin(e){e.preventDefault();axios.post('/api/auth/signin',{username:input.id,password:input.pw}).then(function(response){console.log(response);if(response.data!=null){dispatch(setMessage(response.data));console.log(message);}var token=response.headers.authorization;console.log(token);localStorage.setItem(\"accessToken\",token);var decoded=jwt_decode(token);console.log(decoded);dispatch(login(decoded.sub));console.log(isLogin);if(!response.data.message){navigate('/');dispatch(setMessage(\"\"));}}).catch(function(error){console.log(error);});set_input(_objectSpread(_objectSpread({},input),{},{pw:\"\"}));};useEffect(function(){if(code){axios.get('/klogin',{params:{code:code}}).then(function(response){console.log(response);setKPerson(response.data);window.history.pushState(kperson,null,\"http://localhost:3000/\");});}});return/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col min-h-screen bg-gray-100 border border-gray-300 shadow-xl rounded-xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center flex-1 max-w-sm px-2 mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full px-6 py-8 text-black bg-white rounded shadow-md\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-8 text-2xl text-center text-primary\",children:\"Login\"}),message?/*#__PURE__*/_jsx(\"div\",{children:message}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onClickLogin,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"w-full p-3 mb-4 bg-white input input-primary\",name:\"email\",placeholder:\"Email\",value:input.id,onChange:function onChange(e){return set_input(_objectSpread(_objectSpread({},input),{},{id:e.target.value}));}}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"w-full p-3 mb-4 bg-white input input-primary\",name:\"password\",placeholder:\"Password\",value:input.pw,onChange:function onChange(e){return set_input(_objectSpread(_objectSpread({},input),{},{pw:e.target.value}));}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"w-full font-bold bg-blue-500 border-none btn btn-primary\",children:\"\\uB85C\\uADF8\\uC778\"})]}),/*#__PURE__*/_jsx(\"a\",{href:KAKAO_AUTH_URL,children:/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"w-full mt-3 font-bold text-black bg-yellow-300 border-none btn btn-warning\",children:[/*#__PURE__*/_jsx(RiKakaoTalkFill,{className:\"mr-2 text-2xl\"}),\"\\uCE74\\uCE74\\uC624\\uB85C \\uB85C\\uADF8\\uC778\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end mt-3\",children:[/*#__PURE__*/_jsx(Link,{to:\"/findid\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xs\",children:\"\\uC544\\uC774\\uB514 \\uCC3E\\uAE30\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"ml-1 mr-1 text-xs text-gray-300\",children:\"|\"}),/*#__PURE__*/_jsx(Link,{to:\"/findpw\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xs\",children:\"\\uBE44\\uBC00\\uBC88\\uD638 \\uCC3E\\uAE30\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex mt-6 text-grey-dark\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \",children:\"\\uD68C\\uC6D0\\uC774 \\uC544\\uB2C8\\uC2E0\\uAC00\\uC694?\"}),/*#__PURE__*/_jsx(\"p\",{herf:\"#\",className:\"ml-3 font-bold text-blue-700 underline underline-offset-2 hover:cursor-pointer\",children:/*#__PURE__*/_jsx(Link,{to:\"/signup/\",children:\"\\uD68C\\uC6D0\\uAC00\\uC785\"})})]})]})});}","map":{"version":3,"names":["RiKakaoTalkFill","Link","useNavigate","axios","setMessage","login","jwt_decode","useSelector","useDispatch","useState","useEffect","Login","isLoggedIn","state","userRole","REST_API_KEY","REDIRECT_URI","KAKAO_AUTH_URL","kperson","setKPerson","params","URLSearchParams","window","location","search","code","get","navigate","message","isLogin","dispatch","id","pw","input","set_input","onClickLogin","e","preventDefault","post","username","password","then","response","console","log","data","token","headers","authorization","localStorage","setItem","decoded","sub","catch","error","history","pushState","target","value"],"sources":["C:/Users/zmzm3/git/omo/omo-prj/src/main/react-prj-sample-main/src/components/Login.jsx"],"sourcesContent":["import { RiKakaoTalkFill } from \"react-icons/ri\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { setMessage, login } from \"../stores/actions\";\nimport jwt_decode from 'jwt-decode'\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useState, useEffect } from \"react\";\n\nexport default function Login() {\n  const isLoggedIn = useSelector(state => state.isLoggedIn);\n  const userRole = useSelector(state => state.userRole);\n  const REST_API_KEY = \"8ef1d7ff4079cc081e948ea0988aafea\";\n  const REDIRECT_URI = \"http://localhost:3000/klogin\";\n\n  const KAKAO_AUTH_URL = `https://kauth.kakao.com/oauth/authorize?client_id=${REST_API_KEY}&redirect_uri=${REDIRECT_URI}&response_type=code&prompt=login;`\n\n  const [kperson, setKPerson] = useState('')\n\n\n  const params = new URLSearchParams(window.location.search);\n  const code = params.get(\"code\");\n\n\n  const navigate = useNavigate()\n\n  const message = useSelector(state => state.message)\n  const isLogin = useSelector(state => state.isLoggedIn);\n  const dispatch = useDispatch();\n\n  const [input, set_input] = useState({\n    id: '',\n    pw: ''\n  })\n  const onClickLogin = (e) => {\n    e.preventDefault();\n\n    axios.post('/api/auth/signin', {\n      username: input.id,\n      password: input.pw\n    }).then(response => {\n      console.log(response)\n      if (response.data != null) {\n        dispatch(setMessage(response.data))\n        console.log(message)\n      }\n      const token = response.headers.authorization;\n      console.log(token)\n      localStorage.setItem(\"accessToken\", token)\n      const decoded = jwt_decode(token)\n      console.log(decoded);\n\n      dispatch(login(decoded.sub));\n      console.log(isLogin);\n      if (!response.data.message) {\n        navigate('/')\n        dispatch(setMessage(\"\"))\n      }\n    }).catch(error => {\n      console.log(error);\n    });\n    set_input({ ...input, pw: \"\" })\n  }\n\n  useEffect(() => {\n    if (code) {\n      axios.get('/klogin',\n        { params: { code: code } }\n      ).then(response => {\n        console.log(response)\n        setKPerson(response.data)\n        window.history.pushState(kperson, null, \"http://localhost:3000/\");\n      })\n    }\n  })\n\n\n  return (\n    <div className=\"flex flex-col min-h-screen bg-gray-100 border border-gray-300 shadow-xl rounded-xl\">\n      <div className=\"flex flex-col items-center justify-center flex-1 max-w-sm px-2 mx-auto\">\n        <div className=\"w-full px-6 py-8 text-black bg-white rounded shadow-md\">\n          <h1 className=\"mb-8 text-2xl text-center text-primary\">Login</h1>\n          {message ?\n            <div>{message}</div>\n            :\n            <></>}\n          <form onSubmit={onClickLogin}>\n            <input\n              type=\"text\"\n              className=\"w-full p-3 mb-4 bg-white input input-primary\"\n              name=\"email\"\n              placeholder=\"Email\"\n              value={input.id}\n              onChange={(e) => set_input({ ...input, id: e.target.value })}\n            />\n\n            <input\n              type=\"password\"\n              className=\"w-full p-3 mb-4 bg-white input input-primary\"\n              name=\"password\"\n              placeholder=\"Password\"\n              value={input.pw}\n              onChange={(e) => set_input({ ...input, pw: e.target.value })}\n            />\n\n            <button\n              type=\"submit\"\n              className=\"w-full font-bold bg-blue-500 border-none btn btn-primary\"\n            >\n              로그인\n            </button>\n          </form>\n          <a href={KAKAO_AUTH_URL}>\n            <button\n              type=\"submit\"\n              className=\"w-full mt-3 font-bold text-black bg-yellow-300 border-none btn btn-warning\"\n            >\n\n              <RiKakaoTalkFill className=\"mr-2 text-2xl\" />\n              카카오로 로그인\n            </button>\n          </a>\n          <div className=\"flex justify-end mt-3\">\n            <Link to=\"/findid\">\n              <p className=\"text-xs\">아이디 찾기</p>\n            </Link>\n            <p className=\"ml-1 mr-1 text-xs text-gray-300\">|</p>\n            <Link to=\"/findpw\">\n              <p className=\"text-xs\">비밀번호 찾기</p>\n            </Link>\n          </div>\n        </div>\n\n        <div className=\"flex mt-6 text-grey-dark\">\n          <p className=\"font-semibold \">회원이 아니신가요?</p>\n          <p\n            herf=\"#\"\n            className=\"ml-3 font-bold text-blue-700 underline underline-offset-2 hover:cursor-pointer\"\n          >\n            <Link to=\"/signup/\">회원가입</Link>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}